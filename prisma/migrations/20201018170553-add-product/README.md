# Migration `20201018170553-add-product`

This migration has been generated by dannying at 10/18/2020, 8:05:53 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "public"."User" ALTER COLUMN "name" SET NOT NULL

CREATE TABLE "public"."Product" (
"id" SERIAL,
"name" text   NOT NULL ,
"count" Decimal(65,30)   NOT NULL DEFAULT 1,
"storeId" integer   NOT NULL ,
"price" integer   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE UNIQUE INDEX "Product.name_unique" ON "public"."Product"("name")

ALTER TABLE "public"."Product" ADD FOREIGN KEY ("storeId")REFERENCES "public"."Store"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20201018142957-add-uniq..20201018170553-add-product
--- datamodel.dml
+++ datamodel.dml
@@ -3,25 +3,35 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 model Store {
-  id        Int     @default(autoincrement()) @id
-  name      String
-  users     User[]  @relation(references: [id])
+  id       Int       @id @default(autoincrement())
+  name     String
+  products Product[]
+  users    User[]    @relation(references: [id])
 }
 model User {
-  id       Int     @default(autoincrement()) @id
+  id       Int     @id @default(autoincrement())
   password String  @default("")
-  name     String? @unique
-  stores   Store[] @relation(references: [id])
+  name     String  @unique
+  stores   Store[]
   role     Role    @default(SALLER)
 }
+model Product {
+  id      Int    @id @default(autoincrement())
+  name    String @unique
+  count   Float  @default(1)
+  store   Store  @relation(fields: [storeId], references: [id])
+  storeId Int
+  price   Int
+}
+
 enum Role {
   ADMIN
   SALLER
-}
+}
```


